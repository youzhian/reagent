<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:include="include::head('试剂库存管理')">
<head>
    <meta charset="UTF-8">
    <title>出库列表</title>
</head>
<body>
<div id="app" style="min-height: 700px;">
    <el-card shadow="always">
    <el-row>
        <el-button type="primary" icon="el-icon-refresh-left" size="mini" round @click="refresh">刷新</el-button>
    </el-row>
    </el-card>
    <el-card shadow="always">
        <el-tabs tab-position="top"  v-model="activeName" @tab-click="tabClick">
            <el-tab-pane v-for="(r,i) in reagents" :key="r.reagentId" :name="r.reagentId+''">
                <span slot="label">{{r.reagentName}}  <el-badge :value="r.stock" :max="100" style="margin-top: 10px;"></el-badge></span>
                <el-row v-if="activeName==r.reagentId+''">
                    <el-form :inline="true" :model="queryForm" class="demo-form-inline">
                        <el-form-item label="出入库">
                            <el-select v-model="queryForm.delFlg" placeholder="出入库">
                                <el-option label="全部" value="" selected></el-option>
                                <el-option label="出库" value="1" ></el-option>
                                <el-option label="入库" value="0"></el-option>
                            </el-select>
                        </el-form-item>
                        <el-form-item>
                            <el-button type="primary" icon="el-icon-search">查询</el-button>
                        </el-form-item>
                    </el-form>

                </el-row>
                <el-card shadow="always">
                    <el-table
                            :data="tableData"
                            stripe
                            border
                            style="width: 100%">
                        <el-table-column
                                width="50px"
                                align="center"
                                label="序号"
                                type="index"
                                :index="indexMethod">
                        </el-table-column>
                        <el-table-column
                                label="试剂名称"
                                prop="reagentName">
                        </el-table-column>
                        <el-table-column
                                label="出库\入库"
                                prop="stockType"
                                :formatter="formatStockType">
                        </el-table-column>
                        <el-table-column
                                label="数量"
                                prop="num">
                        </el-table-column>
                        <el-table-column
                                label="操作人"
                                prop="operator">
                        </el-table-column>
                        <el-table-column
                                label="创建时间"
                                prop="createTime">
                        </el-table-column>
                        <el-table-column
                                label="操作" width="200px">

                            <template slot-scope="scope">
                                <el-button size="mini"
                                           type="danger"
                                           @click="toDelete(scope.$index, scope.row)" icon="el-icon-delete">删除</el-button>
                            </template>
                        </el-table-column>
                    </el-table>
                </el-card>
            </el-tab-pane>
        </el-tabs>
    </el-card>
</div>
</body>
<script th:inline="javascript">

    var ctp= /*[[@{/}]]*/ "/";

    new Vue({
        el: '#app',
        data: function () {
                return {
                    reagents:[],
                    activeName:'',
                    queryForm:{

                    },
                    tableData:[],
                    stockDetail:{
                        id:'',
                        reagentId:'',
                        reagentName:'',
                        stockType:'',
                        num:0,
                        operator:'',
                        operatorId:'',
                        createTime:'',
                    },
                }
            },
        created: function(){
            let that = this;
            that.refresh();

        },
        methods: {

            //刷新数据
            refresh:function(){
                let that = this;
                axios.get(ctp+"stock/getStock")
                    .then((response)=>{
                        let code = response.data.code;
                        if(code == "200"){
                            that.reagents = response.data.data;
                            if(that.reagents.length>0){
                                that.activeName = that.reagents[0].reagentId+""
                            }
                        }
                    }).catch((error)=>{
                    that.$message({
                        type: 'error',
                        message: '查询失败!:'+error
                    });
                })
            },
            tabClick:function(e){
                console.log("tabClick",e)
            },
            formatStockType:function(row,column,cellValue){
                return '';
            },
            toDelete:function(index, row){

            },
            indexMethod(index){

                return index+1;
            },
        },
    });
</script>
</html>